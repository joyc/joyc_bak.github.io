<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hython, Python" />










<meta name="description" content="想啥说啥">
<meta name="keywords" content="python,hython">
<meta property="og:type" content="website">
<meta property="og:title" content="Hython Note">
<meta property="og:url" content="http://hython.com/index.html">
<meta property="og:site_name" content="Hython Note">
<meta property="og:description" content="想啥说啥">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hython Note">
<meta name="twitter:description" content="想啥说啥">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'PYBPMT4ZQI',
      apiKey: '',
      indexName: 'hythonblog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://hython.com/"/>





  <title>Hython Note</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a1f5a09bc8f4658af1f37340c553b9c0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hython Note</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">嗨森 Learning Python</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hython.com/2018/05/26/redis-ubuntu1804/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hython">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hython Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/26/redis-ubuntu1804/" itemprop="url">Ubuntu18.04下的Redis常用操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-26T12:15:01+09:00">
                2018-05-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Infrastructure/" itemprop="url" rel="index">
                    <span itemprop="name">Infrastructure</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/26/redis-ubuntu1804/" class="leancloud_visitors" data-flag-title="Ubuntu18.04下的Redis常用操作">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Ubuntu18-04中安装Redis"><a href="#Ubuntu18-04中安装Redis" class="headerlink" title="Ubuntu18.04中安装Redis"></a>Ubuntu18.04中安装Redis</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ol>
<li><p>先对系统的依赖环境进行更新</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get upgrade</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装Redis</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install redis-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果需要安装成服务的话执行</span></span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> redis-server.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确认安装的版本</span></span><br><span class="line">$ redis-server -v</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="启动和停止"><a href="#启动和停止" class="headerlink" title="启动和停止"></a>启动和停止</h3><p>默认情况下直接在终端输入<code>redis-server</code>即可临时性启动Redis服务，再新开终端输入<code>redis-cli</code>启动客户端连接。</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ redis-server       # 启动服务</span><br><span class="line">$ redis-cli          # 启动客户端</span><br><span class="line">$ redis-cli shutdown # 关闭服务</span><br></pre></td></tr></table></figure>
</code></pre><p>如果出现以上命令无法关闭<code>redis-server</code>的情况下解决办法如下：</p>
<ul>
<li><p>使用以下命令启动重启和关闭</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ /etc/init.d/redis-server stop     # 停止</span><br><span class="line">$ /etc/init.d/redis-server start    # 启动</span><br><span class="line">$ /etc/init.d/redis-server restart  # 重启</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>我的安装情况是默认安装后保护模式和后台启动模式均为开启状态，根据需要配置为关闭。<br>查看下面的<strong>简单配置</strong>。</li>
</ul>
<h3 id="查看进程状态以及强制停止"><a href="#查看进程状态以及强制停止" class="headerlink" title="查看进程状态以及强制停止"></a>查看进程状态以及强制停止</h3><p>Linux命令来查看和杀掉进程来强制关闭服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ps aux | grep &quot;redis&quot;</span><br><span class="line">$ sudo pkill pid</span><br></pre></td></tr></table></figure>
<h3 id="连接测试"><a href="#连接测试" class="headerlink" title="连接测试"></a>连接测试</h3><p>直接输入<code>redis-cli</code>通过默认客户端来测试连接，正常情况下返回<code>ping</code>的对应值<code>PONG</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli</span><br><span class="line"></span><br><span class="line">$ 127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line">$ 127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>
<h3 id="简单配置"><a href="#简单配置" class="headerlink" title="简单配置"></a>简单配置</h3><p>通过编辑默认配置文件来初步简单配置，推荐<code>copy</code>并重命名配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/redis/redis.conf</span><br></pre></td></tr></table></figure>
<p>打开远程连接并关闭保护模式，否则只允许本地连接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 把以下注释掉（前面加#）</span><br><span class="line">bind 127.0.0.1 ::1</span><br><span class="line"># 以下改为 yes → no</span><br><span class="line">protected-mode no</span><br><span class="line"></span><br><span class="line"># 如果需要，设置验证密码</span><br><span class="line">requirepass YOURPASSPHRASE</span><br></pre></td></tr></table></figure>
<p>以上设置也可以通过客户端设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; CONFIG SET requirepass YOURPASSPHRASE</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; AUTH YOURPASSPHRASE</span><br><span class="line">Ok</span><br></pre></td></tr></table></figure>
<p>设置密码后的连接方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli -h 127.0.0.1 -p 6379 -a YOURPASSPHRASE  #其他参数如未改动则可省略</span><br></pre></td></tr></table></figure>
<p>保存后重启服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo service redis-server restart</span><br></pre></td></tr></table></figure>
<p>如果需要更改内存的限制可以进行以下设置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">maxmemory 256mb</span><br><span class="line">maxmemory-policy allkeys-lru</span><br></pre></td></tr></table></figure>
<p>设置后需要重启redis服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl restart redis-server.service</span><br></pre></td></tr></table></figure>
<h2 id="Mac下的RedisDesktopManager管理工具"><a href="#Mac下的RedisDesktopManager管理工具" class="headerlink" title="Mac下的RedisDesktopManager管理工具"></a>Mac下的RedisDesktopManager管理工具</h2><p>由于Win版是可以免费下载，Mac和Ubuntu版本如果想免费试用是需下载源码编译的，<br>这里放出编译后的最新版本：</p>
<blockquote>
<p>百度盘：<br><a href="https://pan.baidu.com/s/13AF0rY5l_LYmZnb4AJdgNw" target="_blank" rel="noopener">https://pan.baidu.com/s/13AF0rY5l_LYmZnb4AJdgNw</a></p>
</blockquote>
<h2 id="连接不上的问题解决"><a href="#连接不上的问题解决" class="headerlink" title="连接不上的问题解决"></a>连接不上的问题解决</h2><p>我本地首次使用Mac的rdm来连接时出现以下问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2018-05-26 10:11:42 : Connection: Cancel running commands</span><br><span class="line">2018-05-26 10:11:42 : Connection: Disconnect on error: Connection error: Connection refused</span><br><span class="line">2018-05-26 10:15:26 : Connection: mac-ubuntu &gt; connection failed</span><br><span class="line">2018-05-26 11:14:19 : Connection: AUTH</span><br><span class="line">2018-05-26 11:14:19 : Connection: mac-ubuntu &gt; connected</span><br><span class="line">2018-05-26 11:14:19 : Connection: mac-ubuntu &gt; Response received : -DENIED Redis is running in protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the loopback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command &apos;CONFIG SET protected-mode no&apos; from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet if you do so. Use CONFIG REWRITE to make this change permanent. 2) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to &apos;no&apos;, and then restarting the server. 3) If you started the server manually just for testing, restart it with the &apos;--protected-mode no&apos; option. 4) Setup a bind address or an authentication password. NOTE: You only need to do one of the above things in order for the server to start accepting connections from the outside.</span><br></pre></td></tr></table></figure>
<p>通过设置以上的简单设置开启本地连接并关闭保护模式重启服务后解决此问题。<br>以下是爬取flask官方文档后的保存数据的截图：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/383-2d3f11309ca60e1f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="成功存入Redis"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hython.com/2018/05/23/install-mongodb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hython">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hython Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/install-mongodb/" itemprop="url">Mac和Ubuntu18.04下MongoDB的安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T00:13:17+09:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Infrastructure/" itemprop="url" rel="index">
                    <span itemprop="name">Infrastructure</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/23/install-mongodb/" class="leancloud_visitors" data-flag-title="Mac和Ubuntu18.04下MongoDB的安装">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Mac安装mongodb"><a href="#Mac安装mongodb" class="headerlink" title="Mac安装mongodb"></a>Mac安装mongodb</h2><p>###使用<code>home-brew</code>安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew install mongoldb</span><br></pre></td></tr></table></figure></p>
<p>从默认的配置文件启动mongodb</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --config /usr/local/etc/mongod.conf</span><br></pre></td></tr></table></figure>
<p>安装完成后，MongoDB服务启动、停止、重启命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew services start mongodb</span><br><span class="line">brew services stop mongodb</span><br><span class="line">brew services restart mongodb</span><br></pre></td></tr></table></figure>
<p>Mac下的mongodb可视化管理工具，推荐使用开源免费的<code>Robo 3T</code>,<br>下载地址：<a href="https://robomongo.org/download" target="_blank" rel="noopener">https://robomongo.org/download</a></p>
<h2 id="Ubuntu下离线安装MongoDB教程"><a href="#Ubuntu下离线安装MongoDB教程" class="headerlink" title="Ubuntu下离线安装MongoDB教程"></a>Ubuntu下离线安装MongoDB教程</h2><p><a href="https://blog.csdn.net/u010858605/article/details/50957610" target="_blank" rel="noopener">https://blog.csdn.net/u010858605/article/details/50957610</a></p>
<ol>
<li>去mongodb官网<br>（<a href="http://www.mongodb.org/downloads）下载linux版本的安装包" target="_blank" rel="noopener">http://www.mongodb.org/downloads）下载linux版本的安装包</a><br><code>mongodb-linux-x86_64-ubuntu1404-3.2.0.tgz</code></li>
</ol>
<ol start="2">
<li><p>将桌面上的安装包拷贝到目录<code>/usr/local</code>下</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp mongodb-linux-x86_64-ubuntu1404-3.2.0.tgz /usr/local</span><br></pre></td></tr></table></figure>
</li>
<li><p>解压安装包</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar xf mongodb-linux-x86_64-ubuntu1404-3.2.0.tgz</span><br></pre></td></tr></table></figure>
</li>
<li><p>将解压后的文件夹名字修改为mongodb</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mv mongodb-linux-x86_64-ubuntu1404-3.2.0 mongodb</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建数据和日志目录</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -pv /mongo/data/&#123;mongodb_data,mongodb_log&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>其中，<code>mongodb_data</code>是数据目录，<code>mongodb_log</code>是日志目录.</p>
<ol start="6">
<li><p>在<code>/mongo/data/mongodb_log</code>目录下新建<code>mongodb.log</code>文件，<code>wq</code>保存退出</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /mongo/data/mongodb_log/mongodb.log</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建配置文件</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 创建配置文件命令：</span><br><span class="line">sudo vim /etc/mongodb.conf</span><br><span class="line"></span><br><span class="line"># 在文件中写入：</span><br><span class="line">port=27017</span><br><span class="line">dbpath=/mongo/data/mongodb_data/</span><br><span class="line">logpath=/mongo/data/mongodb_log/mongodb.log</span><br><span class="line">fork=true</span><br><span class="line">logappend=true</span><br><span class="line">noauth=true</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动mongodb服务</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/local/mongodb/bin/mongod --port 27017 --fork --dbpath=/mongo/data/mongodb_data/ --logpath=/mongo/data/mongodb_log/mongodb.log --logappend</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用mongo</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/local/mongodb/bin/mongo</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭mongodb服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use admin</span><br><span class="line">db.shutdownServer()</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新启动mongodb服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/local/mongodb/bin/mongod --config /etc/mongodb.conf</span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hython.com/2017/08/21/oracle-plsql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hython">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hython Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/21/oracle-plsql/" itemprop="url">Oracle PL/SQL 入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-21T22:17:07+09:00">
                2017-08-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/architecture/" itemprop="url" rel="index">
                    <span itemprop="name">architecture</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/08/21/oracle-plsql/" class="leancloud_visitors" data-flag-title="Oracle PL/SQL 入门">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><h4 id="字符类别"><a href="#字符类别" class="headerlink" title="字符类别"></a>字符类别</h4><table>
<thead>
<tr>
<th>类别</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>\d</td>
<td>任意数字（等同于[0-9]）</td>
</tr>
<tr>
<td>\D</td>
<td>任意非数字字符（等同于[^0-9]）</td>
</tr>
<tr>
<td>\w</td>
<td>任意字母或数字（等同于[a-zA-Z0-9]）</td>
</tr>
<tr>
<td>\W</td>
<td>任意非字母或数字字符（等同于[^a-zA-Z0-9]）</td>
</tr>
<tr>
<td>\s</td>
<td>任意空白字符</td>
</tr>
<tr>
<td>\S</td>
<td>任意非空白字符</td>
</tr>
</tbody>
</table>
<h4 id="重复元字符"><a href="#重复元字符" class="headerlink" title="重复元字符"></a>重复元字符</h4><table>
<thead>
<tr>
<th>元字符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>0个或多个匹配</td>
</tr>
<tr>
<td>+</td>
<td>1个或多个匹配（等价于{1,}）</td>
</tr>
<tr>
<td>?</td>
<td>0个或1个匹配（等价于{0,1}）</td>
</tr>
<tr>
<td>{n}</td>
<td>具体的匹配次数</td>
</tr>
<tr>
<td>{n,}</td>
<td>不少于指定的匹配次数</td>
</tr>
<tr>
<td>{n,m}</td>
<td>匹配的范围</td>
</tr>
</tbody>
</table>
<h4 id="锚元字符"><a href="#锚元字符" class="headerlink" title="锚元字符"></a>锚元字符</h4><table>
<thead>
<tr>
<th>锚</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>^</td>
<td>文本的开头</td>
</tr>
<tr>
<td>$</td>
<td>文本的末尾</td>
</tr>
</tbody>
</table>
<p>^有两种用法：在字符集内（使用[和]定义），使用它来对字符集取反；否则，将把它用于指示字符串的开头。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* SELECT prod_name, vend_id</span></span><br><span class="line"><span class="comment">FROM products; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> vend_id <span class="comment">-- DISTINCT 关键字用法</span></span><br><span class="line"><span class="keyword">FROM</span> products;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price <span class="keyword">BETWEEN</span> <span class="number">5</span> <span class="keyword">AND</span> <span class="number">10</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id = <span class="number">1002</span> <span class="keyword">OR</span> vend_id = <span class="number">1003</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="comment">-- WHERE (vend_id = 1002 OR vend_id = 1003) AND prod_price &gt;= 10</span></span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="keyword">IN</span> (<span class="number">1002</span>,<span class="number">1003</span>) <span class="keyword">AND</span> prod_price &gt;= <span class="number">10</span> <span class="comment">-- 可以使用IN</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">'_ ton anvil%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">REGEXP_LIKE</span> (prod_name, <span class="string">'.000'</span>) <span class="comment">-- 正则函数</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">REGEXP_LIKE</span>(prod_name, <span class="string">'1000|2000|3000'</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">REGEXP_LIKE</span>(prod_name,<span class="string">'[1-5] ton'</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> vend_name</span><br><span class="line"><span class="keyword">FROM</span> vendors</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">REGEXP_LIKE</span>(vend_name, <span class="string">'\.'</span>); <span class="comment">-- 用转义符"\"搜索"."</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="comment">-- WHERE REGEXP_LIKE(prod_name, '\(\d sticks?\)')</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">REGEXP_LIKE</span>(prod_name, <span class="string">'\d&#123;4&#125;'</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>
<h4 id="常用文本操作函数"><a href="#常用文本操作函数" class="headerlink" title="常用文本操作函数"></a>常用文本操作函数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Length()</td>
<td>返回字符串的长度</td>
</tr>
<tr>
<td>Lower()</td>
<td>把字符串转换成小写形式</td>
</tr>
<tr>
<td>LPad()</td>
<td>在字符串左边填充空格</td>
</tr>
<tr>
<td>LTrim()</td>
<td>从字符串左边修剪掉空白</td>
</tr>
<tr>
<td>RPad()</td>
<td>在字符串右边填充空格</td>
</tr>
<tr>
<td>RTrim()</td>
<td>从字符串右边修剪掉空白</td>
</tr>
<tr>
<td>Soundex()</td>
<td>返回字符串的SOUNDEX值</td>
</tr>
<tr>
<td>SubString()</td>
<td>返回字符串内的字符</td>
</tr>
<tr>
<td>Upper()</td>
<td>把字符串转换成大写形式</td>
</tr>
</tbody>
</table>
<h4 id="常用的日期和时间操作函数"><a href="#常用的日期和时间操作函数" class="headerlink" title="常用的日期和时间操作函数"></a>常用的日期和时间操作函数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Add_Month()</td>
<td>给日期添加月份（也可以减去月份）</td>
</tr>
<tr>
<td>Extract()</td>
<td>从日期和时间中减去年、月、日、时、分或秒</td>
</tr>
<tr>
<td>Last_Day()</td>
<td>返回月份的最后一天</td>
</tr>
<tr>
<td>Months_Between()</td>
<td>返回两个月份之间的月数</td>
</tr>
<tr>
<td>Next_Day()</td>
<td>返回指定日期后面的那一天</td>
</tr>
<tr>
<td>Sysdate()</td>
<td>返回当前日期和时间</td>
</tr>
<tr>
<td>To_Date()</td>
<td>把字符串转换成日期</td>
</tr>
</tbody>
</table>
<h4 id="常用的数值操作函数"><a href="#常用的数值操作函数" class="headerlink" title="常用的数值操作函数"></a>常用的数值操作函数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Abs()</td>
<td>返回数字的绝对值</td>
</tr>
<tr>
<td>Cos()</td>
<td>返回指定角度的三角余弦值</td>
</tr>
<tr>
<td>Exp()</td>
<td>返回指定数字的指数值</td>
</tr>
<tr>
<td>Mod()</td>
<td>返回除法运算的余数</td>
</tr>
<tr>
<td>Sin()</td>
<td>返回指定角度的三角正弦值</td>
</tr>
<tr>
<td>Sqrt()</td>
<td>返回指定数字的平方根</td>
</tr>
<tr>
<td>Tan()</td>
<td>返回指定角度的三角正切值</td>
</tr>
</tbody>
</table>
<h4 id="SQL聚合函数"><a href="#SQL聚合函数" class="headerlink" title="SQL聚合函数"></a>SQL聚合函数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>AVG()</td>
<td>返回列的平均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>返回列中的行数</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回列的最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回列的最小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>返回列的值汇总</td>
</tr>
</tbody>
</table>
<ul>
<li><p>可以使用COUNT()的两种方式是：</p>
<ul>
<li>使用COUNT(*)统计表中的行数，无论列包含的是数值还是NULL值；</li>
<li>使用COUNT(column)统计在特定列中具有值（忽略NULL值）的行数。</li>
</ul>
</li>
<li><p>GROUP BY子句必须出现在WHERE子句的后面和ORDER BY子句的前面。</p>
</li>
<li><p>HAVING与WHERE的区别：<br>WHERE过滤发生在数据分组之前，而HAVING过滤则发生在数据分组之后。这是一个重要的区别，被WHERE子句删除的行不会包括在分组中。这可能会改变计算值，基于HAVING子句中使用的那些值，它反过来又可能影响哪些分组将会被过滤。</p>
</li>
</ul>
<h4 id="ORDER-BY与GROUP-BY的比较"><a href="#ORDER-BY与GROUP-BY的比较" class="headerlink" title="ORDER BY与GROUP BY的比较"></a>ORDER BY与GROUP BY的比较</h4><table>
<thead>
<tr>
<th>ORDER BY</th>
<th>GROUP BY</th>
</tr>
</thead>
<tbody>
<tr>
<td>对生成的输出进行排序</td>
<td>对行进行分组，不过输出可能没有采用分组顺序</td>
</tr>
<tr>
<td>可能使用任意列（甚至包括没有选择的列）</td>
<td>只可能使用所选的列或表达式列，并且一定会使用所有选择的列表达式</td>
</tr>
<tr>
<td>从来都不是必需的</td>
<td>如果结合使用列（或表达式）与聚合函数，则是必需的</td>
</tr>
</tbody>
</table>
<h4 id="SELECT子句和它们的顺序"><a href="#SELECT子句和它们的顺序" class="headerlink" title="SELECT子句和它们的顺序"></a>SELECT子句和它们的顺序</h4><table>
<thead>
<tr>
<th>子句</th>
<th>描述</th>
<th>是否必需</th>
</tr>
</thead>
<tbody>
<tr>
<td>SELECT</td>
<td>要返回的列或表达式</td>
<td>是</td>
</tr>
<tr>
<td>FROM</td>
<td>要从中检索数据的表</td>
<td>是（Oracle）</td>
</tr>
<tr>
<td>WHERE</td>
<td>行级过滤</td>
<td>否</td>
</tr>
<tr>
<td>GROUP BY</td>
<td>分组规范</td>
<td>仅当按分组计算聚合值时是必需的</td>
</tr>
<tr>
<td>HAVING</td>
<td>分组级过滤</td>
<td>否</td>
</tr>
<tr>
<td>ORDER BY</td>
<td>输出的排列顺序</td>
<td>否</td>
</tr>
</tbody>
</table>
<h4 id="查询示例"><a href="#查询示例" class="headerlink" title="查询示例"></a>查询示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RTRIM</span>(vend_name) || <span class="string">',('</span> || <span class="keyword">RTRIM</span>（vend_country） || <span class="string">')'</span></span><br><span class="line"><span class="keyword">AS</span> vend_title</span><br><span class="line"><span class="keyword">FROM</span> vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> prod_id, quantity, item_price,</span><br><span class="line">       quantity * item_price <span class="keyword">AS</span> expanded_price</span><br><span class="line"><span class="keyword">FROM</span> orderitems</span><br><span class="line"><span class="keyword">WHERE</span> order_num = <span class="number">20005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> cust_id, order_num</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">WHERE</span> order_date = <span class="keyword">TO_DATE</span>(<span class="string">'2015-02-01'</span>, <span class="string">'yyyy-mm-dd'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> cust_id, order_num</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">WHERE</span> order_date&gt;= <span class="keyword">TO_DATE</span>(<span class="string">'2015-02-01'</span>, <span class="string">'yyyy-mm-dd'</span>)</span><br><span class="line">   <span class="keyword">AND</span> order_date&lt; <span class="keyword">TO_DATE</span>(<span class="string">'2015-02-02'</span>, <span class="string">'yyyy-mm-dd'</span>);</span><br><span class="line">   </span><br><span class="line"><span class="keyword">SELECT</span> cust_id, order_num</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="comment">-- 检索order_date在2015年和2月的所有行</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">Extract</span>(<span class="keyword">Year</span> <span class="keyword">FROM</span> order_date) = <span class="number">2015</span></span><br><span class="line">   <span class="keyword">AND</span> <span class="keyword">Extract</span>(<span class="keyword">Month</span> <span class="keyword">FROM</span> order_date) = <span class="number">2</span>;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(prod_price) <span class="keyword">AS</span> avg_price</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id = <span class="number">1003</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_cust</span><br><span class="line"><span class="keyword">FROM</span> customers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(cust_email) <span class="keyword">AS</span> num_cust</span><br><span class="line"><span class="keyword">FROM</span> customers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(quantity) <span class="keyword">AS</span> items_ordered</span><br><span class="line"><span class="keyword">FROM</span> orderitems</span><br><span class="line"><span class="keyword">WHERE</span> order_num = <span class="number">20005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(item_price*quantity) <span class="keyword">AS</span> total_price</span><br><span class="line"><span class="keyword">FROM</span> orderitems</span><br><span class="line"><span class="keyword">WHERE</span> order_num = <span class="number">20005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_items,</span><br><span class="line">       <span class="keyword">MIN</span>(prod_price) <span class="keyword">AS</span> price_min,</span><br><span class="line">       <span class="keyword">MAX</span>(prod_price) <span class="keyword">AS</span> price_max,</span><br><span class="line">       <span class="keyword">AVG</span>(prod_price) <span class="keyword">AS</span> price_avg</span><br><span class="line"><span class="keyword">FROM</span> products;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> vend_id, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_prods </span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id; <span class="comment">-- GROUP BY 聚合分组</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> cust_id, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> orders</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cust_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt;= <span class="number">2</span>; <span class="comment">-- HAVING用于过滤分组 等同于过滤行的 WHERE</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 列出具有2件或更多产品并且价格在10以上（含10）的所有供应商 */</span></span><br><span class="line"><span class="keyword">SELECT</span> vend_id, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_prods</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price &gt;= <span class="number">10</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt;= <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 检索总价在50以上（含50）的所有订单的订单号和订单总价,并按订单总价对输出进行排序 */</span></span><br><span class="line"><span class="keyword">SELECT</span> order_num, <span class="keyword">SUM</span>(quantity * item_price) <span class="keyword">AS</span> order_total</span><br><span class="line"><span class="keyword">FROM</span> orderitems</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> order_num</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">SUM</span>(quantity * item_price) &gt;= <span class="number">50</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> order_total;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 子查询：查询订购商品TNT2的所有顾客的信息，下面有连接表方法查询 */</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> cust_id</span><br><span class="line">                  <span class="keyword">FROM</span> orders</span><br><span class="line">                  <span class="keyword">WHERE</span> order_num <span class="keyword">IN</span> (<span class="keyword">SELECT</span> order_num</span><br><span class="line">                                      <span class="keyword">FROM</span> orderitems</span><br><span class="line">                                      <span class="keyword">WHERE</span> prod_id = <span class="string">'TNT2'</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> cust_name,</span><br><span class="line">       cust_state,</span><br><span class="line">       (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">       <span class="keyword">FROM</span> orders</span><br><span class="line">       <span class="keyword">WHERE</span> orders.cust_id = customers.cust_id) <span class="keyword">AS</span> orders <span class="comment">-- orders为计算字段</span></span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 表的连接，必须使用完全限定的列名（用点号把表和列分隔开） */</span></span><br><span class="line"><span class="keyword">SELECT</span> vend_name, prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> vendors, products</span><br><span class="line"><span class="keyword">WHERE</span> vendors.vend_id = products.vend_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name, prod_name;</span><br><span class="line"><span class="comment">-- 等同于下面的内连接，WHERE更简化，INNER更清晰</span></span><br><span class="line"><span class="keyword">SELECT</span> vend_name, prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> vendors <span class="keyword">INNER</span> <span class="keyword">JOIN</span> products</span><br><span class="line"><span class="keyword">ON</span> vendors.vend_id = products.vend_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name, prod_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 显示了订单号20005中的商品</span></span><br><span class="line"><span class="keyword">SELECT</span> prod_name, vend_name, prod_price, quantity</span><br><span class="line"><span class="keyword">FROM</span> orderitems, products, vendors</span><br><span class="line"><span class="keyword">WHERE</span> products.vend_id = vendors.vend_id</span><br><span class="line">   <span class="keyword">AND</span> orderitems.prod_id = products.prod_id</span><br><span class="line">   <span class="keyword">AND</span> order_num = <span class="number">20005</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 使用连接表：查询订购商品TNT2的所有顾客的信息，上面有子查询方法 */</span></span><br><span class="line"><span class="comment">-- WHERE连接表</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> customers, orders, orderitems</span><br><span class="line"><span class="keyword">WHERE</span> customers.cust_id = orders.cust_id</span><br><span class="line">   <span class="keyword">AND</span> orderitems.order_num = orders.order_num</span><br><span class="line">   <span class="keyword">AND</span> prod_id = <span class="string">'TNT2'</span>;</span><br><span class="line"><span class="comment">-- FROM子句，INNER JOIN ON实现</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orders <span class="keyword">ON</span> customers.cust_id = orders.cust_id</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orderitems <span class="keyword">ON</span> orderitems.order_num = orders.order_num</span><br><span class="line"><span class="keyword">WHERE</span> prod_id = <span class="string">'TNT2'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="表别名和列别名"><a href="#表别名和列别名" class="headerlink" title="表别名和列别名"></a>表别名和列别名</h3><p>列别名使用 <code>AS</code>:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RTrim</span>(vend_name) || <span class="string">', ('</span> || <span class="keyword">RTrim</span>(vend_country) || <span class="string">')'</span></span><br><span class="line">  <span class="keyword">AS</span> vend_title</span><br><span class="line"><span class="keyword">FROM</span> vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure></p>
<p>表别名如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> customers c, orders o, orderitems oi</span><br><span class="line"><span class="keyword">WHERE</span> c.cust_id = o.cust_id</span><br><span class="line">  <span class="keyword">AND</span> oi.order_num = o.order_num</span><br><span class="line">  <span class="keyword">AND</span> prod_id = <span class="string">'TNT2'</span>;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>注意：只在查询执行期间使用表别名。与列别名不同，表别名永远不会返回给客户。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 查询商品ID为DTNTR的商品的同一个供应商制造的所有产品 */</span></span><br><span class="line"><span class="comment">-- 子查询方法</span></span><br><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name </span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id = (<span class="keyword">SELECT</span> vend_id</span><br><span class="line">                 <span class="keyword">FROM</span> products</span><br><span class="line">                 <span class="keyword">WHERE</span> prod_id = <span class="string">'DTNTR'</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_id;</span><br><span class="line"><span class="comment">/* 自连接 */</span></span><br><span class="line"><span class="comment">-- 连接表 WHERE</span></span><br><span class="line"><span class="keyword">SELECT</span> p1.prod_id, p1.prod_name</span><br><span class="line"><span class="keyword">FROM</span> products p1, products p2</span><br><span class="line"><span class="keyword">WHERE</span> p1.vend_id = p2.vend_id</span><br><span class="line">    <span class="keyword">AND</span> p2.prod_id = <span class="string">'DTNTR'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_id;</span><br><span class="line"><span class="comment">-- 连接表 INNER JOIN ON</span></span><br><span class="line"><span class="keyword">SELECT</span> p1.prod_id, p1.prod_name</span><br><span class="line"><span class="keyword">FROM</span> products p1</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> products p2 <span class="keyword">ON</span> p1.vend_id = p2.vend_id</span><br><span class="line"><span class="keyword">WHERE</span> p2.prod_id = <span class="string">'DTNTR'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 自然连接 */</span></span><br><span class="line"><span class="keyword">SELECT</span> c.*, o.order_num, o.order_date,   <span class="comment">-- c.*为customers表中所有列</span></span><br><span class="line">            oi.prod_id, oi.quantity, OI.item_price</span><br><span class="line"><span class="keyword">FROM</span> customers c, orders o, orderitems oi</span><br><span class="line"><span class="keyword">WHERE</span> c.cust_id = o.cust_id</span><br><span class="line">   <span class="keyword">AND</span> oi.order_num = o.order_num</span><br><span class="line">   <span class="keyword">AND</span> prod_id = <span class="string">'FB'</span>;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">SELECT</span> c.*, o.order_num, o.order_date,</span><br><span class="line">            oi.prod_id, oi.quantity, OI.item_price</span><br><span class="line"><span class="keyword">FROM</span> customers c</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orders o <span class="keyword">ON</span> c.cust_id = o.cust_id</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orderitems oi <span class="keyword">ON</span> oi.order_num = o.order_num</span><br><span class="line"><span class="keyword">WHERE</span> prod_id = <span class="string">'FB'</span>;   </span><br><span class="line"></span><br><span class="line"><span class="comment">/* 外连接：检索所有顾客及其订单 */</span></span><br><span class="line"><span class="keyword">SELECT</span> c.cust_id, o.order_num</span><br><span class="line"><span class="keyword">FROM</span> customers c</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orders o <span class="keyword">ON</span> c.cust_id = o.cust_id;</span><br><span class="line"><span class="comment">-- 检索所有顾客的列表，包括那些没有下订单的顾客</span></span><br><span class="line"><span class="keyword">SELECT</span> customers.cust_id, orders.order_num</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> orders <span class="keyword">ON</span> customers.cust_id = orders.cust_id;</span><br></pre></td></tr></table></figure>
<p>与将两个表中的行相关联的内连接不同，外连接还包括没有相关行的行。<br>当使用<code>OUTER JOIN</code>语法时，必须使用RIGHT或LEFT关键字指定要包括所有行的表（RIGHT用于OUTER JOIN右边的表，LEFT则用于左边的表）。前面的示例在FROM子句中使用LEFT OUTER JOIN从左边的表（customers表）中选择所有的行。要从右边的表中选择所有的行，可以使用<code>RIGHT OUTER JOIN</code>。</p>
<blockquote>
<p>外连接类型:<br>有两种基本的外连接形式：左外连接和右外连接，它们之间的唯一区别是相关联的表的顺序。换句话说，可以把左外连接转变成右外连接，只需在FROM或WHERE子句中颠倒表的顺序即可。因此，可以互换地使用两类外连接，而要使用哪种外连接则取决于方便性。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 检查所有顾客的列表以及每位顾客下的订单数量 */</span></span><br><span class="line"><span class="comment">-- 内连接</span></span><br><span class="line"><span class="keyword">SELECT</span> customers.cust_name,</span><br><span class="line">       <span class="keyword">COUNT</span>(orders.order_num) <span class="keyword">AS</span> num_ord</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orders <span class="keyword">ON</span> customers.cust_id = orders.cust_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> customers.cust_name;</span><br><span class="line"><span class="comment">-- 外连接</span></span><br><span class="line"><span class="keyword">SELECT</span> customers.cust_name,</span><br><span class="line">       <span class="keyword">COUNT</span>(orders.order_num) <span class="keyword">AS</span> num_ord</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> orders <span class="keyword">ON</span> customers.cust_id = orders.cust_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> customers.cust_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 组合查询 UNION */</span></span><br><span class="line"><span class="comment">/* 价格在5以下的所有产品，包括由供应商1001和1002制造的所有产品,不管价格 */</span></span><br><span class="line"><span class="keyword">SELECT</span> vend_id, prod_id, prod_price</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price &lt;= <span class="number">5</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> vend_id, prod_id, prod_price</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="keyword">IN</span> (<span class="number">1001</span>,<span class="number">1002</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_id, prod_price;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> vend_id, prod_id, prod_price</span><br><span class="line"><span class="keyword">FROM</span> products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price &lt;= <span class="number">5</span></span><br><span class="line">  <span class="keyword">OR</span> vend_id <span class="keyword">IN</span> (<span class="number">1001</span>,<span class="number">1002</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用UNION ALL，Oracle将不会消除重复的行。</p>
</blockquote>
<h3 id="INSERT-插入的用法"><a href="#INSERT-插入的用法" class="headerlink" title="INSERT 插入的用法"></a>INSERT 插入的用法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* INSERT语句用法示例 */</span></span><br><span class="line"><span class="comment">-- 下面是依赖列顺序的，强烈不推荐</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">10006</span>,</span><br><span class="line">       <span class="string">'Pep E. LaPew'</span>,</span><br><span class="line">       <span class="string">'100 Main Street'</span>,</span><br><span class="line">       <span class="string">'Los Angeles'</span>,</span><br><span class="line">       <span class="string">'CA'</span>,</span><br><span class="line">       <span class="string">'90046'</span>,</span><br><span class="line">       <span class="string">'USA'</span>,</span><br><span class="line">       <span class="literal">NULL</span>,</span><br><span class="line">       <span class="literal">NULL</span>);</span><br><span class="line"><span class="comment">-- 推荐写法</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers(cust_id,</span><br><span class="line">                      cust_name,</span><br><span class="line">                      cust_address,</span><br><span class="line">                      cust_city,</span><br><span class="line">                      cust_state,</span><br><span class="line">                      cust_zip,</span><br><span class="line">                      cust_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">10006</span>,</span><br><span class="line">       <span class="string">'Pep E. LaPew'</span>,</span><br><span class="line">       <span class="string">'100 Main Street'</span>,</span><br><span class="line">       <span class="string">'Los Angeles'</span>,</span><br><span class="line">       <span class="string">'CA'</span>,</span><br><span class="line">       <span class="string">'90046'</span>,</span><br><span class="line">       <span class="string">'USA'</span>);</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line"><span class="comment">-- 使用INSERT SELECT把custnew中的所有数据导入到customers中       </span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> custnew(cust_id,</span><br><span class="line">                    cust_contact,</span><br><span class="line">                    cust_email,</span><br><span class="line">                    cust_name,</span><br><span class="line">                    cust_address,</span><br><span class="line">                    cust_city,</span><br><span class="line">                    cust_state,</span><br><span class="line">                    cust_zip,</span><br><span class="line">                    cust_country)</span><br><span class="line"><span class="keyword">SELECT</span> cust_id,</span><br><span class="line">       cust_contact,</span><br><span class="line">       cust_email,</span><br><span class="line">       cust_name,</span><br><span class="line">       cust_address,</span><br><span class="line">       cust_city,</span><br><span class="line">       cust_state,</span><br><span class="line">       cust_zip,</span><br><span class="line">       cust_country</span><br><span class="line"><span class="keyword">FROM</span> custnew;</span><br></pre></td></tr></table></figure>
<h3 id="UPDATE更新数据"><a href="#UPDATE更新数据" class="headerlink" title="UPDATE更新数据"></a>UPDATE更新数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 更新顾客10005的电子邮件</span></span><br><span class="line"><span class="keyword">UPDATE</span> customers</span><br><span class="line"><span class="keyword">SET</span> cust_email = <span class="string">'elmer@fudd.com'</span></span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="number">10005</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 更新多列数据</span></span><br><span class="line"><span class="keyword">UPDATE</span> customers</span><br><span class="line"><span class="keyword">SET</span> cust_name = <span class="string">'The Fudds'</span>,</span><br><span class="line">    cust_email = <span class="string">'elmer@fudd.com'</span></span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="number">10005</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 更新为空值（删除列）</span></span><br><span class="line"><span class="keyword">UPDATE</span> customers</span><br><span class="line"><span class="keyword">SET</span> cust_email = <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="number">10005</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>UPDATE语句需要结束于一个WHERE子句，它告诉Oracle要更新哪一行,否则更新所有行。</p>
</blockquote>
<h3 id="DELETE删除数据的使用"><a href="#DELETE删除数据的使用" class="headerlink" title="DELETE删除数据的使用"></a>DELETE删除数据的使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 从customers表中删除单独一行</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="number">10006</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>DELETE不接受列名或者通配符，它将删除整行，而不是删除列。要删除特定的列，可以使用UPDATE语句。<br>永远不要执行不带有WHERE子句的UPDATE或DELETE，除非确实打算更新和删除每一行。</p>
</blockquote>
<h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---------------------------------------------</span></span><br><span class="line"><span class="comment">-- Create customers table</span></span><br><span class="line"><span class="comment">---------------------------------------------</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers</span><br><span class="line">(</span><br><span class="line">  cust_id   <span class="built_in">int</span>      <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  cust_name <span class="built_in">char</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  cust_address <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_city    <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_state   <span class="built_in">char</span>(<span class="number">5</span>)   <span class="literal">NULL</span> ,</span><br><span class="line">  cust_zip     <span class="built_in">char</span>(<span class="number">10</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_country <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_contact <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_email   <span class="built_in">char</span>(<span class="number">255</span>) <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">---------------------------------------------</span></span><br><span class="line"><span class="comment">-- Create orderitems table</span></span><br><span class="line"><span class="comment">---------------------------------------------</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orderitems</span><br><span class="line">(</span><br><span class="line">  order_num  <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  order_item <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  prod_id    <span class="built_in">char</span>(<span class="number">10</span>)     <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  quantity   <span class="built_in">int</span>          <span class="keyword">DEFAULT</span> <span class="number">1</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> , <span class="comment">-- 设置默认值</span></span><br><span class="line">  item_price <span class="built_in">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="ALTER-TABLE更新表定义"><a href="#ALTER-TABLE更新表定义" class="headerlink" title="ALTER TABLE更新表定义"></a>ALTER TABLE更新表定义</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 向表中添加一列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> vendors</span><br><span class="line"><span class="keyword">ADD</span> vend_phone <span class="built_in">CHAR</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除添加列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> vendors</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> vend_phone;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 定义主键</span></span><br><span class="line"><span class="comment">----------------------</span></span><br><span class="line"><span class="comment">-- Define primary keys</span></span><br><span class="line"><span class="comment">----------------------</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> customers <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_customers</span><br><span class="line">                      PRIMARY <span class="keyword">KEY</span> (cust_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orderitems <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_orderitems</span><br><span class="line">                       PRIMARY <span class="keyword">KEY</span> (order_num, order_item);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orders <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_orders</span><br><span class="line">                   PRIMARY <span class="keyword">KEY</span> (order_num);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> products <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_products</span><br><span class="line">                     PRIMARY <span class="keyword">KEY</span> (prod_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> vendors <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_vendors</span><br><span class="line">                    PRIMARY <span class="keyword">KEY</span> (vend_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> productnotes <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_productnotes</span><br><span class="line">                         PRIMARY <span class="keyword">KEY</span> (note_id);      </span><br><span class="line">                         </span><br><span class="line"><span class="comment">-- 定义外键</span></span><br><span class="line"><span class="comment">---------------------------------------------</span></span><br><span class="line"><span class="comment">-- Define foreign keys</span></span><br><span class="line"><span class="comment">---------------------------------------------</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orderitems</span><br><span class="line">      <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_orderitems_orders FOREIGN <span class="keyword">KEY</span> (order_num)</span><br><span class="line">      <span class="keyword">REFERENCES</span> orders (order_num);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orderitems</span><br><span class="line">      <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_orderitems_products</span><br><span class="line">      FOREIGN <span class="keyword">KEY</span> (prod_id) <span class="keyword">REFERENCES</span> products (prod_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orders</span><br><span class="line">      <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_orders_customers FOREIGN <span class="keyword">KEY</span> (cust_id)</span><br><span class="line">      <span class="keyword">REFERENCES</span> customers (cust_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> products</span><br><span class="line">      <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_products_vendors</span><br><span class="line">      FOREIGN <span class="keyword">KEY</span> (vend_id) <span class="keyword">REFERENCES</span> vendors (vend_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> productnotes</span><br><span class="line">      <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_productnotes_products</span><br><span class="line">      FOREIGN <span class="keyword">KEY</span> (prod_id) <span class="keyword">REFERENCES</span> products (prod_id);</span><br></pre></td></tr></table></figure>
<h4 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 永久删除整个表customers2</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> customers2;</span><br></pre></td></tr></table></figure>
<h4 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> customers2 <span class="keyword">RENAME</span> <span class="keyword">TO</span> customers;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hython.com/2017/07/30/python-new-class/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hython">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hython Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/30/python-new-class/" itemprop="url">Python面向对象中：经典类和新式类的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-30T10:08:47+09:00">
                2017-07-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learnpython/" itemprop="url" rel="index">
                    <span itemprop="name">learnpython</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/07/30/python-new-class/" class="leancloud_visitors" data-flag-title="Python面向对象中：经典类和新式类的区别">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Python 2.x中默认都是经典类，只有显式继承了object才是新式类<br>Python 3.x中默认都是新式类，不必显式的继承object<br>当类是经典类时，多继承情况下，会按照深度优先方式查找<br>当类是新式类时，多继承情况下，会按照广度优先方式查找</p>
</blockquote>
<ol>
<li><p>写法不一样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class A:</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">class B(object):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>
</li>
<li><p>在多继承中，新式类采用广度优先搜索，而经典类是采用深度优先搜索。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># 经典类例子</span><br><span class="line">class A:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;This is A&apos;</span><br><span class="line">    def save(self):</span><br><span class="line">        print &apos;save method from A&apos;</span><br><span class="line">class B (A):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;this is B&apos;</span><br><span class="line">class C (A):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;this is C&apos;</span><br><span class="line">    def save(self):</span><br><span class="line">        print &apos;save mothod from C&apos;</span><br><span class="line">class D(B,C):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;this is D&apos;</span><br><span class="line">d=D()</span><br><span class="line">d.save()</span><br><span class="line"># 输出结果：经典类的搜索顺序是D-&gt;B-&gt;A，是一种深度优先查找方式</span><br><span class="line">this is D</span><br><span class="line">save method from A</span><br><span class="line"></span><br><span class="line"># 新式类例子：</span><br><span class="line">class A(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;This is A&apos;</span><br><span class="line">    def save(self):</span><br><span class="line">        print &apos;save method from A&apos;</span><br><span class="line">class B (A):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;this is B&apos;</span><br><span class="line">class C (A):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;this is C&apos;</span><br><span class="line">    def save(self):</span><br><span class="line">        print &apos;save mothod from C&apos;</span><br><span class="line">class D(B,C):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print &apos;this is D&apos;</span><br><span class="line">d=D()</span><br><span class="line">d.save()</span><br><span class="line"></span><br><span class="line"># 运行结果：新式类的搜索顺序是D-&gt;B-&gt;C-&gt;A，是一种广度优先查找方式</span><br><span class="line">this is D</span><br><span class="line">save mothod from C</span><br></pre></td></tr></table></figure>
</li>
<li><p>新式类新增</p>
<ol>
<li>新式类对象可以直接通过<code>__class__</code>属性获取自身类型:<code>type</code></li>
<li>新式类增加了<code>__getattribute__</code>方法</li>
<li>新式类增加了<code>__slots__</code>内置属性, 可以把实例属性的种类锁定到<code>__slots__</code>规定的范围之中。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class Person(object):</span><br><span class="line">__slots__ = (&apos;name&apos;, &apos;age&apos;)   #只允许Person拥有name和age属性</span><br><span class="line">def __init__(self):</span><br><span class="line">    self.name=&apos;aline&apos;</span><br><span class="line">    self.age=20</span><br><span class="line">    self.sex=&apos;female&apos;</span><br><span class="line">person=Person()</span><br><span class="line"></span><br><span class="line"># 运行结果：报错</span><br><span class="line">AttributeError: &apos;Person&apos; object has no attribute &apos;sex&apos;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hython.com/2017/06/25/LearnApacheSolr/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hython">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hython Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/25/LearnApacheSolr/" itemprop="url">Apache Solr 学习入门 (一)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-25T00:07:05+09:00">
                2017-06-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/architecture/" itemprop="url" rel="index">
                    <span itemprop="name">architecture</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/25/LearnApacheSolr/" class="leancloud_visitors" data-flag-title="Apache Solr 学习入门 (一)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>学习环境：<br>OS：CentOS 7 mini<br>Apache Solr 6.3.0</p>
</blockquote>
<h3 id="Solr的安装"><a href="#Solr的安装" class="headerlink" title="Solr的安装"></a>Solr的安装</h3><ol>
<li>从<a href="https://archive.apache.org/dist/lucene/solr/" target="_blank" rel="noopener"><code>Solr Release Page</code></a> 可以下载到过去的历史版本。</li>
<li><code>tar xzvf solr-6.3.0.tgz</code>解压到指定目录下，就可以直接启动了。如下命令可以启动sample data：  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;solr&#125;/bin/solr start -e tecjproducts</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><code>Solritas UI</code> : <a href="http://localhost:8983/solr/techproducts/browse" target="_blank" rel="noopener">http://localhost:8983/solr/techproducts/browse</a>  </p>
<ol start="3">
<li>solr的停止和重启：  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[solr@min02 solr63]$ bin/solr stop -p 8983  </span><br><span class="line">[solr@min02 solr63]$ bin/solr restart</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Solr-Core-的准备"><a href="#Solr-Core-的准备" class="headerlink" title="Solr Core 的准备"></a>Solr Core 的准备</h3><ol start="4">
<li><p>core (solrbook) 的创建：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[solr@min02 solr63]$ bin/solr create_core -c solrbook -d basic_configs</span><br><span class="line">Copying configuration to new core instance directory:</span><br><span class="line">/mnt/apps/solr63/server/solr/solrbook</span><br><span class="line">Creating new core &apos;solrbook&apos; using command:</span><br><span class="line">http://localhost:8983/solr/admin/cores?action=CREATE&amp;name=solrbook&amp;instanceDir=solrbook</span><br><span class="line">&#123;</span><br><span class="line">  &quot;responseHeader&quot;:&#123;</span><br><span class="line">    &quot;status&quot;:0,</span><br><span class="line">    &quot;QTime&quot;:4950&#125;,</span><br><span class="line">  &quot;core&quot;:&quot;solrbook&quot;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>solr core的重载：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[solr@min02 solr63]$ curl &quot;http://192.168.2.122:8983/solr/admin/cores?action=RELOAD&amp;core=solrbook&quot;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;response&gt;</span><br><span class="line">&lt;lst name=&quot;responseHeader&quot;&gt;&lt;int name=&quot;status&quot;&gt;400&lt;/int&gt;&lt;int name=&quot;QTime&quot;&gt;194&lt;/int&gt;&lt;/lst&gt;&lt;lst name=&quot;error&quot;&gt;&lt;lst name=&quot;metadata&quot;&gt;&lt;str name=&quot;error-class&quot;&gt;org.apache.solr.common.SolrException&lt;/str&gt;&lt;str name=&quot;root-error-class&quot;&gt;org.apache.solr.common.SolrException&lt;/str&gt;&lt;/lst&gt;&lt;str name=&quot;msg&quot;&gt;Core with core name [solrbook] does not exist.&lt;/str&gt;&lt;int name=&quot;code&quot;&gt;400&lt;/int&gt;&lt;/lst&gt;</span><br><span class="line">&lt;/response&gt;</span><br><span class="line">[solr@min02 solr63]$</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Schema的定义"><a href="#Schema的定义" class="headerlink" title="Schema的定义"></a>Schema的定义</h3><ol start="6">
<li>通过<code>Schema API</code>新加<code>schema.xml</code>定义field：  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[solr@min02 solr63]$ curl -X POST -H &apos;Content-type:application/json&apos; --data-binary &apos;&#123;&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;id&quot;,&quot;type&quot;:&quot;string&quot;,&quot;indexed&quot;:&quot;true&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;true&quot;,&quot;multiValued&quot;:&quot;false&quot;&#125;&#125;&apos; http://192.168.2.122:8983/solr/solrbook/schema</span><br><span class="line">&#123;</span><br><span class="line">  &quot;responseHeader&quot;:&#123;</span><br><span class="line">    &quot;status&quot;:0,</span><br><span class="line">    &quot;QTime&quot;:87&#125;,</span><br><span class="line">  &quot;errors&quot;:[&#123;</span><br><span class="line">      &quot;add-field&quot;:&#123;</span><br><span class="line">        &quot;name&quot;:&quot;id&quot;,</span><br><span class="line">        &quot;type&quot;:&quot;string&quot;,</span><br><span class="line">        &quot;indexed&quot;:&quot;true&quot;,</span><br><span class="line">        &quot;stored&quot;:&quot;true&quot;,</span><br><span class="line">        &quot;required&quot;:&quot;true&quot;,</span><br><span class="line">        &quot;multiValued&quot;:&quot;false&quot;&#125;,</span><br><span class="line">      &quot;errorMessages&quot;:[&quot;Field &apos;id&apos; already exists.\n&quot;]&#125;]&#125;</span><br><span class="line">[solr@min02 conf]$ curl -X POST -H &apos;Content-type:application/json&apos; --data-binary &apos;&#123;&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;title&quot;,&quot;type&quot;:&quot;text_ja&quot;,&quot;indexed&quot;:&quot;true&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;false&quot;&#125;,&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;sumamry&quot;,&quot;type&quot;:&quot;text_ja&quot;,&quot;indexed&quot;:&quot;true&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;false&quot;&#125;&#125;&apos; http://192.168.2.122:8983/solr/solrbook/schema</span><br><span class="line">&#123;</span><br><span class="line">  &quot;responseHeader&quot;:&#123;</span><br><span class="line">    &quot;status&quot;:0,</span><br><span class="line">    &quot;QTime&quot;:633&#125;&#125;</span><br><span class="line">[solr@min02 conf]$ </span><br><span class="line">[solr@min02 conf]$ vi managed-schema </span><br><span class="line">[solr@min02 conf]$ curl -X POST -H &apos;Content-type:application/json&apos; --data-binary &apos;&#123;&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;author&quot;,&quot;type&quot;:&quot;string&quot;,&quot;indexed&quot;:&quot;false&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;true&quot;&#125;,&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;intended_reader&quot;,&quot;type&quot;:&quot;string&quot;,&quot;indexed&quot;:&quot;false&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;true&quot;&#125;,&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;genre&quot;,&quot;type&quot;:&quot;string&quot;,&quot;indexed&quot;:&quot;false&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;true&quot;&#125;,&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;isbn&quot;,&quot;type&quot;:&quot;string&quot;,&quot;indexed&quot;:&quot;false&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;true&quot;&#125;&#125;&apos; http://192.168.2.122:8983/solr/solrbook/schema</span><br><span class="line">&#123;</span><br><span class="line">  &quot;responseHeader&quot;:&#123;</span><br><span class="line">    &quot;status&quot;:0,</span><br><span class="line">    &quot;QTime&quot;:488&#125;&#125;</span><br><span class="line">[solr@min02 conf]$ curl -X POST -H &apos;Content-type:application/json&apos; --data-binary &apos;&#123;&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;pub_date&quot;,&quot;type&quot;:&quot;date&quot;,&quot;indexed&quot;:&quot;true&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;false&quot;&#125;&#125;&apos; http://192.168.2.122:8983/solr/solrbook/schema</span><br><span class="line">&#123;</span><br><span class="line">  &quot;responseHeader&quot;:&#123;</span><br><span class="line">    &quot;status&quot;:0,</span><br><span class="line">    &quot;QTime&quot;:267&#125;&#125;</span><br><span class="line">[solr@min02 conf]$ curl -X POST -H &apos;Content-type:application/json&apos; --data-binary &apos;&#123;&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;price&quot;,&quot;type&quot;:&quot;tint&quot;,&quot;indexed&quot;:&quot;true&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;false&quot;&#125;,&quot;add-field&quot;:&#123;&quot;name&quot;:&quot;pages&quot;,&quot;type&quot;:&quot;tint&quot;,&quot;indexed&quot;:&quot;false&quot;,&quot;stored&quot;:&quot;true&quot;,&quot;required&quot;:&quot;false&quot;,&quot;multiValued&quot;:&quot;false&quot;&#125;&#125;&apos; http://192.168.2.122:8983/solr/solrbook/schema</span><br><span class="line">&#123;</span><br><span class="line">  &quot;responseHeader&quot;:&#123;</span><br><span class="line">    &quot;status&quot;:0,</span><br><span class="line">    &quot;QTime&quot;:242&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>添加完后在schema.xml（6.x 是manage schema）中就可以看到定义的field了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;field name=&quot;author&quot; type=&quot;string&quot; multiValued=&quot;true&quot; indexed=&quot;false&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;genre&quot; type=&quot;string&quot; multiValued=&quot;true&quot; indexed=&quot;false&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;id&quot; type=&quot;string&quot; multiValued=&quot;false&quot; indexed=&quot;true&quot; required=&quot;true&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;intended_reader&quot; type=&quot;string&quot; multiValued=&quot;true&quot; indexed=&quot;false&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;isbn&quot; type=&quot;string&quot; multiValued=&quot;true&quot; indexed=&quot;false&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;pages&quot; type=&quot;tint&quot; multiValued=&quot;false&quot; indexed=&quot;false&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;price&quot; type=&quot;tint&quot; multiValued=&quot;false&quot; indexed=&quot;true&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;pub_date&quot; type=&quot;date&quot; multiValued=&quot;false&quot; indexed=&quot;true&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;sumamry&quot; type=&quot;text_ja&quot; multiValued=&quot;false&quot; indexed=&quot;true&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;field name=&quot;title&quot; type=&quot;text_ja&quot; multiValued=&quot;false&quot; indexed=&quot;true&quot; required=&quot;false&quot; stored=&quot;true&quot;/&gt;</span><br></pre></td></tr></table></figure></p>
<pre><code>也可以导入配置好的solr_schema.json文件使之反应到schema定义文件中：  
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H &apos;Content-type:application/json&apos; --data-binary @solrbook_schema.json http://192.168.2.122:8983/solr/solrbook/schema</span><br></pre></td></tr></table></figure>
<h3 id="文件的提交更新和删除"><a href="#文件的提交更新和删除" class="headerlink" title="文件的提交更新和删除"></a>文件的提交更新和删除</h3><ol start="6">
<li><p>添加文件，可以使用post tool和curl两种方法：  </p>
<ol>
<li><p>使用post tool投入json/xml数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[solr@min02 solr63]$ bin/post -c solrbook /mnt/hgfs/shared/examples/ch03/json-sample.json </span><br><span class="line">java -classpath /mnt/apps/solr63/dist/solr-core-6.3.0.jar -Dauto=yes -Dc=solrbook -Ddata=files org.apache.solr.util.SimplePostTool /mnt/hgfs/shared/examples/ch03/json-sample.json</span><br><span class="line">SimplePostTool version 5.0.0</span><br><span class="line">Posting files to [base] url http://localhost:8983/solr/solrbook/update...</span><br><span class="line">Entering auto mode. File endings considered are xml,json,jsonl,csv,pdf,doc,docx,ppt,pptx,xls,xlsx,odt,odp,ods,ott,otp,ots,rtf,htm,html,txt,log</span><br><span class="line">POSTing file json-sample.json (application/json) to [base]/json/docs</span><br><span class="line">1 files indexed.</span><br><span class="line">COMMITting Solr index changes to http://localhost:8983/solr/solrbook/update...</span><br><span class="line">Time spent: 0:00:01.210</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用curl投入json/xml数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[solr@min02 ch03]$ curl &quot;http://192.168.2.122:8983/solr/solrbook/update?commit=true&quot; --data-binary @json-sample.json -H &apos;Content-type:text/json; charset=utf-8&apos;</span><br><span class="line">&#123;&quot;responseHeader&quot;:&#123;&quot;status&quot;:0,&quot;QTime&quot;:265&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>除此登录方法之外还有可使用<code>stream.file/stream.url</code> 参数来直接传递本地文件登录。前提是需要将solrconfig.xml中的设置<code>&lt;requestParsers enableRemoteStreaming=&quot;true&quot;</code>打开。  </p>
</li>
</ol>
</li>
<li><p>文件更新，id，unique key设定为前提，跟新加一样，支持json/xml/csv的post和curl来更新：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;http://192.168.2.122:8983/solr/solrbook/update?commit=true&quot; --data-binary @update.json -H &apos;Content-type:text/json; charset=utf-8&apos;</span><br><span class="line">bin/post -c solrbook $&#123;EXAMPLE&#125;/ch03/update.json</span><br></pre></td></tr></table></figure>
</li>
<li><p>局部更新可以使用修饰子<code>set</code>，<code>add(multiValue=true时候)</code>，<code>remove</code>等记述在数据中，如下json文件格式：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> &#123;&quot;id&quot;: &quot;http://sample.com/book?id=001&quot;,</span><br><span class="line">  &quot;title&quot;: &#123;&quot;set&quot;:&quot;Apache Solr 入門 改訂&quot;&#125;,</span><br><span class="line">  &quot;author&quot;: &#123;&quot;add&quot;:[&quot;西潟 一生&quot;]&#125;</span><br><span class="line"> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>文档的删除有两种方法，一是指定unique key删除，二是使用query删除：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;delete&quot;:&#123;&quot;id&quot;:&quot;http://sample.com/book?id=001&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;delete&quot;:&#123;&quot;id&quot;:[&quot;http://sample.com/book?id=001&quot;,&quot;http://xxx&quot;]&#125;&#125;</span><br><span class="line">&#123;&quot;delete&quot;:&#123;&quot;query&quot;:&quot;author:xxx&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>post tool:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ $&#123;SOLR&#125;/bin/post -c solrbook $&#123;EXAMPLE&#125;/ch03/del.json -format solr</span><br></pre></td></tr></table></figure>
</li>
<li><p>curl:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl &quot;http://192.168.2.122:8983/solr/solrbook/update?commit=true&quot; --data-binary @del.json -H &apos;Content-type:text/json; charset=utf-8&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>commit=true</code> 和 <code>rollback=true</code></p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://hython.com/2016/11/27/python2-7-windows-pip/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hython">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hython Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/27/python2-7-windows-pip/" itemprop="url">Python2.7.X Windows下之Pip安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-27T19:18:00+09:00">
                2016-11-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learnpython/" itemprop="url" rel="index">
                    <span itemprop="name">learnpython</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2016/11/27/python2-7-windows-pip/" class="leancloud_visitors" data-flag-title="Python2.7.X Windows下之Pip安装">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h5><p>在书<a href="https://learnpythonthehardway.org" target="_blank" rel="noopener">learn python the hardway</a>的<a href="https://learnpythonthehardway.org/book/ex46.html" target="_blank" rel="noopener">EX46</a>练习中，需要安装<code>pip</code>,<code>setuptools</code>等模块。<br>由于网上找到的资料过时，在此记录Windows10下的安装过程。</p>
<ul>
<li>pip from <a href="http://pypi.python.org/pypi/pip" target="_blank" rel="noopener">http://pypi.python.org/pypi/pip</a></li>
<li>setuptools from <a href="https://pypi.python.org/pypi/setuptools" target="_blank" rel="noopener">https://pypi.python.org/pypi/setuptools</a></li>
<li>distribute from <a href="http://pypi.python.org/pypi/distribute" target="_blank" rel="noopener">http://pypi.python.org/pypi/distribute</a></li>
<li>nose from <a href="http://pypi.python.org/pypi/nose/" target="_blank" rel="noopener">http://pypi.python.org/pypi/nose/</a></li>
<li>virtualenv from <a href="http://pypi.python.org/pypi/virtualenv" target="_blank" rel="noopener">http://pypi.python.org/pypi/virtualenv</a></li>
</ul>
<p>以pip为例，下载source file即可。<br><img src="http://upload-images.jianshu.io/upload_images/383-0a25a04bf15c95d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="下载说明"><br>下载并解压PIP等文件，我的结构如下。<br><img src="http://upload-images.jianshu.io/upload_images/383-bf1cf5984e5b08e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="解压目录"></p>
<h6 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h6><ul>
<li>方法1（联网情况下）<br>使用官方说明的<a href="https://bootstrap.pypa.io/get-pip.py" target="_blank" rel="noopener">get-pip.py</a>，并运行如下命令：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python get-pip.py</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>安装如下：<br><img src="http://upload-images.jianshu.io/upload_images/383-0dc2b9f6a38b01fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="get-pip.py"></p>
<ul>
<li>方法2（断网情况下）<br>在解压好的pip目录下运行<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>之后的安装同理。<br>有了pip就可以自由管理自己的module了。</p>
<p>安装nose完毕后便可以测试自己的框架是否配置正确，<br>我的测试如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/383-5266c764dab853a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="测试结果"><br>第一次test由于字符编码问题没有通过，改正后就通过了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/avatar.jpg"
                alt="Hython" />
            
              <p class="site-author-name" itemprop="name">Hython</p>
              <p class="site-description motion-element" itemprop="description">想啥说啥</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/joyc" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/i599" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://douban.com/people/cnbee" target="_blank" title="豆瓣">
                      
                        <i class="fa fa-fw fa-globe"></i>豆瓣</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hython</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("pvlmQpYgFlpxJkcRXB06B0X0-gzGzoHsz", "l7qu2rdaMv4RfuKegc8vpidS");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
